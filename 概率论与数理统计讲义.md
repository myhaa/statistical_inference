---
tite: 概率论与数理统计讲义
author: lijie
date: 20200501
---

[TOC]



[参考1](https://wenku.baidu.com/view/164c20cb910ef12d2bf9e701.html)

[参考2](https://wenku.baidu.com/view/4edad7dec67da26925c52cc58bd63186bceb922e.html?fr=search)

# 第一章：随机事件与概率

## 1.1 随机事件及其运算

### 1.1.1 随机现象

#### 例子

* 一天内进入某超市的顾客数
* 某种型号手机的寿命

#### 定义

* 在一定的条件下，并不总出现相同结果的现象

#### 特点

* 结果不止一个
* 事先不知道哪一个会出现

#### 统计规律性

* 随机现象的各种结果会表现出一定的规律性

### 1.1.2 几种概念

#### 随机试验

* 对**随机现象**进行的实验与观察
* 2个特定
  * 随机性
  * 重复性

#### 样本空间$\Omega$

* 所有**样本点**构成的集合
* 样本点
  * 随机试验的每一个可能结果
* 两类样本空间
  * 离散：样本点有限个或可列个
  * 连续：样本点无限不可列个
* 样本空间的分割
  * 若$A_i,A_2,...,A_n$有这两点特点
    1. $A_i$互不相容
    2. $A_1\cup A_2 \cup ... \cup A_n=\Omega$
  * 则称$A_i,A_2,...,A_n$为$\Omega$的一组分割

### 1.1.3 随机事件

#### 定义

* 某些样本点组成的集合
* 样本空间$\Omega$的子集，常用A、B、C、...表示

#### 分类

* 基本事件
  * $\Omega$的单点集
* 必然事件
  * $\Omega$
* 不可能事件
  * 空集$\varphi$

#### 事件的表示

* 语言：在试验中，A中某个样本点出现了，就说A出现了、发生了，记为A
* 集合：维恩图
* ==随机变量==

#### 事件间的关系

* 包含关系
  * $A\subset B$
  * A发生导致B发生
* 相等关系
  * A=B
* 互不相容
  * A和B不可能同时发生

#### ==事件间的运算==

* 并
  * $A\cup B$
  * A、B至少有一发生
* 交
  * $A\cap B$
  * A、B同时发生
* 差
  * A-B
  * A发生但B不发生
* 对立
  * $\bar A$
  * A不发生
* 对应维恩图

![图片来源于网络](C:\Users\lijie\Desktop\讲课\图片\eg1.png)

* 一些公式

![图片来源于网络](C:\Users\lijie\Desktop\讲课\图片\eg2.png)

![图片来源于网络](C:\Users\lijie\Desktop\讲课\图片\eg4.png)

![图片来源于网络](C:\Users\lijie\Desktop\讲课\图片\eg5.png)

#### 事件域

* 设$\Omega$为样本空间，$\Phi$是由$\Omega$的子集组成的集合类，若$\Phi$满足以下三点，则称$\Phi$为一个事件域，又称为$\sigma$域
  * $\Omega \in \Phi$
  * 若$A\in \Phi$，则对应事件$\bar A \in \Phi$
  * 若$A_n \in \Phi, n=1,2,3,...$，则可列并$\cup_{n=1}^{\infty}{A_n}\in \Phi$

#### ==练习==

##### 1

口袋中有a个白球、b个黑球，从中一个一个不返回地取球。

A = 取到最后一个是白球

B = 取到最后一段是白球

问A与B的关系？

##### 2

若A是B的子事件，则$​

* $$
  A\cup B = ? \\
  AB = ?
  $$

##### 3

试用A\B\C表示下列事件

* 仅A出现
* 恰有一个出现
* 至多有一个出现
* 至多有两个出现
* 不都出现

### 1.1.4 随机变量

#### 定义

* 表示==随机现象==结果的变量
* 常用X、Y、Z、...表示

### 1.1.5 本节小结

![图片来源于网络](C:\Users\lijie\Desktop\讲课\图片\eg3.png)

### 1.1.6 练习

* 课本练习题

## 1.2 概率的定义及其确定方法

### 1.2.1 概率的定义

#### 直观定义

* 事件A出现的可能性大小

#### 统计定义

* 事件A在大量重复试验下出现的频率的稳定值称为该事件的概率

#### ==公理化定义==

* 非负性
  * $P(A)\geq0$
* 正则性
  * $P(\Omega)=1$
* 可列可加性
* 若$A_1, A_2, ..., A_n, ...$互不相容，则$P(\cup_{i=1}^{\infty}A_i)=\sum_{i=1}^{\infty}{P(A_i)}$

### 1.2.2 概率的确定方法

#### 排列组合

##### 排列

* 从n个元素中任取r个，求取法有多少种
* 排列要按照顺序，是有序的
* 全排列
  * $P_n = n!$
* $0!=1$
* 重复排列
  * $n^r$
* 选排列
  * $p_n^r=\frac{n!}{(n-r)!}=n(n-1)...(n-r+1)$

##### 组合

* $C_n^r=\frac{n!}{r!(n-r)!}$
* 重复组合
  * 重复组合(combination with repetition)是一种特殊的[组合](https://baike.baidu.com/item/组合/12004197)，从n个不同元素中可重复地选取m个元素，不管其顺序合成一组，称为从n个元素中取m个元素的可重复组合
  * $C_{n+r-1}^r$
* 组合是无序的

##### ==注意==

* 求排列、组合时，要掌握和注意
  * 加法原则
  * 乘法原则

##### 加法原则

* 完成某件事情有n类途径，在第一类途径中有$m_1$中方法，在第二类中有$m_2$种，依此类推，在第n类种有$m_n$种，则完成这件事共有$m_1+m_2+...+m_n$种不同的方法

##### 乘法原理

* 完成某件事情需先后分成n个步骤，做第一步有$m_1$种，…，做第n步有$m_n$，则共有$m_1*...*m_n$种不同方法

##### 练习

###### 1

6根草，头两两相接，尾两两相接，==求成环的概率？==

hint：乘法原理

###### 2

n个人围一圆桌坐，==求甲、乙相邻而坐的概率？==

###### 3

n个人坐成一排，==求甲、乙相邻而坐的概率？==

#### 频率方法

* 随机试验可大量重复进行
* 进行n次重复试验，记n(A)为事件A的频数
* 称$f_n(A)=\frac{n(A)}{n}$为时间A的频率
* 频率$f_n(A)$会稳定于某一常数（稳定值）
* 用该稳定值作为该事件的==概率==

#### 古典方法

* 设$\Omega$为样本空间，若
  * $\Omega$只含有有限个样本点
  * 每个样本点出现的可能性相等
* 则事件A的概率为：
  * $P(A)=\frac{A中样本点的个数}{样本点总数}$

#### 注意

* 抛一枚硬币三次==等价于==抛三枚硬币一次
* $\Omega_1=\{(0,0),(0,1),(1,0),(1,1)\}$
  * 此样本空间中的样本点==等可能==
* $\Omega_2=\{(三正),(二正一反),(二反一正),(三反)\}$
  * 此样本空间中的样本点==不等可能==

#### 几何方法

* 若样本空间$\Omega$充满某个区域，其度量（长度、面积等）为$S_\Omega$
* 落在$\Omega$中的任一子区域A的概率
* 只与子区域的度量$S_A$有关，而与子区域的位置无关（==等可能的==）
* 此时事件A的概率为：$P(A)=\frac{S_\Omega}{A_\Omega}$

#### 例子

##### 蒲丰投针问题

平面上画有间隔为d的等距平行线，向平面任意投掷一枚长为l（l<d）的针，==求针与平行线相交的概率？==

hint：[参考](https://www.zhihu.com/question/34319749)

## 1.3 概率的性质

### 性质1-空集的概率

* $P(\Phi)=0$
* 逆不一定成立

### 性质2-有限可加性

* 若$AB=\Phi$
* 则$P(A\cup B) = P(A) + P(B)$
* 可推广到n个互不相容的事件

### 性质3-对立事件公式

* $P(\bar{A})=1-P(A)$

### 性质4-概率的单调性

* 若$A\supset B$，则$P(A-B)=P(A)-P(B)$且$P(A)\ge P(B)$
* $P(A-B)=P(A)-P(AB)$

### 性质5-加法公式

* $P(A\cup B) = P(A) + P(B)-P(AB)$
* $P(A\cup B \cup C) = P(A) + P(B) + P(C)-P(AB)-P(AC)-P(BC)+P(ABC)$

#### 例子

##### 1

$AB=\Phi, P(A)=0.6, P(A\cup B)=0.8$，==求B的对立事件的概率？==

##### 2

$P(A)=0.4, P(B)=0.3, P(A\cup B)=0.6$，求$P(A-B)$？

##### 3

$P(A)=P(B)=P(C)=\frac{1}{4}, P(AB)=0, P(AC)=P(BC)=\frac{1}{6}$，求A、B、

C都不出现的概率？

##### 4

口罩中有n-1个黑球，1个白球，每次从口袋中随机摸出一球，并换入一只黑球，求第k次取到黑球的概率？

hint：利用对立事件

##### 5

口袋中有2个白球，每次从口袋中随机的摸出一球，并换入一只黑球，求第k次取到黑球的概率？

##### 6

一颗骰子掷4次，求至少出现一次6点的概率？

hint：利用对立事件

##### 7

从1-9中有返回取n次，求取出的n个数的乘积被10整除的概率？

hint：利用对立事件和加法公式，取到5且取到过偶数两个事件

##### 8

甲掷硬币n+1次，乙掷n次，求甲掷出的正面数比乙掷出的正面数多的概率

hint：利用对称性，$P(甲_正>乙_正)=P(n+1-甲_正>n-乙_正)\\=P(甲_反-1<乙_反)=P(甲_反\le乙_反)=1-P(甲_正>乙_正)$

#### 常见模型

##### 不返回抽样-超几何模型

N个产品，其中M个不合格产品，N-M个合格品，从中不返回任取n个，则此n个中有m个不合格品的概率为：
$$
\frac{C_M^m*C_{N-M}^{n-m}}{C_N^n}\\
n\le N,m\le M\\
n-m\le N-M
$$

* 彩票问题

##### 返回抽样

N个产品，其中M个不合格产品，N-M个合格品，从中有返回任取n个，则此n个中有m个不合格品的概率为：
$$
\frac{C_n^m*M^m*(N-M)^{n-m}}{N^n}\\
m\le n
$$

##### 盒子模型

n个不同球放入N个不同的盒子中，每个盒子中所放球不限，求恰有n个盒子中各有一球的概率（$n\le N$）
$$
\frac{P_N^n}{N^n}
$$

* 生日问题-求n个人至少有两人生日相同的概率

##### 配对模型

n个人、n顶帽子、任意取，至少一个人拿对自己帽子的概率

记$A_i$表示第i个人拿对自己帽子，则问题对应为求$P(\cup_{i=1}^n{A_i})$

利用加法公式可求

### 性质6-连续性

#### 事件序列的极限

* 若事件序列$\{F_n\}$满足$F_1\subset F_2\subset ...\subset F_n\subset ...$
  * 则称事件序列$\{F_n\}$为单独不减事件，
  * 其极限事件为：$\lim_{n\rightarrow \infty}{F_n}=\cup_{n=1}^\infty{F_n}$
* 若事件序列$\{F_n\}$满足$F_1\supset F_2\supset ...\supset F_n\supset ...$
  * 则称事件序列$\{F_n\}$为单独不增事件，
  * 其极限事件为：$\lim_{n\rightarrow \infty}{F_n}=\cap_{n=1}^\infty{F_n}$

#### 集合函数的连续性

设P(.)为一个集合函数

* 若对任意单独不减事件序列$\{F_n\}$，有$P(\lim_{n\rightarrow \infty}{F_n})=\lim_{n\rightarrow \infty}{P(F_n)}$
  * 则称P(.)为==下连续的==
* 若对任意单独不增事件序列$\{F_n\}$，有$P(\lim_{n\rightarrow \infty}{F_n})=\lim_{n\rightarrow \infty}{P(F_n)}$
  * 则称P(.)为==上连续的==

#### 概率的连续性

* 若P(.)是事件域$\sigma$上的一个概率函数，则P(.)为==下连续的==，也是==上连续的==

### 性质7-集合函数可列可加性充要条件

* 若P(.)是事件域$\sigma$上满足非负、正则的集合函数，则P(.)有可列可加性的充要条件是它具有==有限可加性==和==下连续性==

## 1.4 ==条件概率==

10张卡片依次分给10个人，有3张写有中奖，已知第1个人没中后，第2个人中的概率是多少？

### 1.4.1 定义

* 对于事件A、B，若$P(B)>0$，则称$P(A|B)=\frac{P(AB)}{P(B)}$为在B出现的条件下，A出现的==条件概率==

#### 例子

10个产品有7个正品，3个次品，从中不返回的抽取2个，已知第一个取到次品，求第2个又取到次品的概率？

hint: 用定义求取$P(A|B)=\frac{P(AB)}{P(B)}$

#### 条件概率是概率

* 条件概率满足概率的三条公理（哪三条？）
* 由此得：
  * $P(A\cup B|C)=P(A|C)+P(B|C)-P(AB|C)$
  * $P(\bar{A}|B)=1-P(A|B)$
  * $P(\Omega |B)=1$
  * $P(B|\Omega)\neq1$
  * $P(A|\Omega)=P(A)$
  * $P(A|A)=1$

#### 练习

$P(A)=0.6, P(A\cup B)=0.84, P(\Omega-B|A)=0.4, P(B)=?$

### 1.4.2 条件概率三大公式

#### 乘法公式

##### 性质

* 若$P(B)>0$，则$P(AB)=P(B)*P(A|B)$
* 若$P(A_1A_2...A_{n-1})>0$，则$P(A_1A_2...A_n)=P(A_1)P(A_2|A_1)...P(A_n|A_1A_2...A_{n-1})$

##### 例子

一批零件共有100个，其中10个不合格品，从中一个个不返回取出，求第三次才取出不合格品得概率？

**解答：**

记$A_i$是第i次取出的是不合格品，$B_i$是第i次取出的是合格品，则求的是$P(B_1B_2A_3)$，用乘法公式即可求出

#### 全概率公式

##### 性质

* 若事件$B_1,B_2,...,B_n$是样本空间的一组分割，且$P(B_i)>0$，则

$$
P(A)=\sum_{i=1}^n{P(AB_i)}=\sum_{i=1}^n{P(B_i)P(A|B_i)}
$$

* 全概率用于求复杂事件的概率
* 使用全概率公式关键在于寻找另一组事件来“分割”样本空间
* 全概率公式最简单的形式

$$
P(A)=P(B)P(A|B)+P(\bar{B})P(A|\bar{B})
$$

* 若事件$B_1,B_2,...,B_n$是互不相容的，且$P(B_i)>0$，则由$A\subset \cup_{i=1}^n{B_i}$可得公式（5）

##### 例子

###### 1

设10件产品中有3件不合格品，从中不返回的取2次，每次一件，求取出第二件为不合格品的概率？

**hint:** 设A=第一次取得不合格品，B=第二次取得不合格品，即求$P(B)$，用全概率公式

###### 2

甲口袋有a只白球，b只黑球；乙口袋有n只白球，m只黑球。从甲口袋任取一球放入乙口袋，然后从乙口袋任取一球，求从乙口袋取出的是白球的概率？

hint：设A=从甲口袋取出的白球，B=从乙口袋取出的白球，即求$P(B)$，用全概率公式

#### 贝叶斯公式

##### 性质

* 若事件$B_1,B_2,...,B_n$是样本空间$\Omega$的一组分割，且$P(A)>0,P(B_i)>0$，则

$$
P(B_i|A)=\frac{P(AB_i)}{P(A)}=\frac{P(B_i)P(A|B_i)}{\sum_{j=1}^n{P(B_j)P(A|B_j)}}
$$

* 事件$B_1,B_2,...,B_n$可以看作是导致A发生的原因
* $P(B_j|A)$是在事件A发生的条件下，某个原因$B_j$发生的概率，称为后验概率
* 贝叶斯公式又称为后验概率公式
* $P(B_j)$为先验概率

##### 例子

某商品由三个厂家供应，其供应量为：甲厂家是乙厂家的2倍；乙、丙两场相等。各厂产品的次品率为2%，2%，4%。若从市场上随机抽取一件此种商品，发现是次品，求它是甲厂生产的概率？

hint：贝叶斯公式，设$A_i$为取到第i厂的产品，B为取到次品，即求$P(A_甲|B)$

#### 三大公式比较

* 乘法公式是求“几个事件同时发生”的概率
* 全概率公式是求“最后结果”的概率
* 贝叶斯公式是已知“最后结果”，求“原因”的概率

## 1.5 独立性

### 1.5.1 两个事件的独立性

#### 定义

* 若事件A与B满足$P(AB)=P(A)P(B)$
* 则称A与B相互独立

#### 结论

* A、B为两个事件，若$P(A)>0$，则A与B独立等价于$P(B|A)=P(B)$

#### 性质

* 若事件A与B独立，则A与$\bar{B}$独立、$\bar{A}$与B独立、$\bar{A}$与$\bar{B}$独立

#### 怎么判断

* 实际应用中，往往根据经验来判断两个事件的独立性
* 例如：甲乙两人分别工作

### 1.5.2 多个事件的独立性

#### 定义

* 若事件$A_1,A_2,...,A_n$满足：两两独立、三三独立、…、nn独立
* 则称事件$A_1,A_2,...,A_n$相互独立

#### 结论

* 若A、B、C相互独立，则
  * $A\cup B$与C独立
  * $A\cap B$与C独立
  * $A-B$与C独立

#### 例子

##### 1

甲乙两人独立的对同一目标射击一次，其命中率分别为0.6和0.7，现已知目标被击中，求它是甲击中的概率？

hint：独立性，设A=甲中，B=乙中，C=被击中，即求$P(A|C)$，贝叶斯公式
$$
P(A|C)=\frac{P(AC)}{P(C)}=\frac{P(A)}{P(A\cup B)}\\
=\frac{P(A)}{P(A)+P(B)-P(AB)}\\
=\frac{P(A)}{P(A)+P(B)-P(A)P(B)}
$$

##### 2

两枪手轮流对同一目标进行设计，甲先射，谁先击中则得胜。每次射击中，甲、乙射中的概率分为为a和b，求甲得胜的概率？

hint：只考虑第一次和第二次，甲中+甲不中乙不中，这样又会开始新一轮循环，则

$P(甲胜)=a+(1-a)(1-b)P(甲胜)$

### 1.5.3 试验的独立性

#### 定义

* 若试验$E_1$的任一结果与试验$E_2$的任一结果都是相互独立的事件，则称这两个试验相互独立

#### n重伯努利试验

##### 伯努利试验

* 若某种试验只有两个结果，则称该试验为伯努利试验
* 在伯努利试验中，一般记“成功”的概率为$p$

##### n重伯努利试验

* n次独立重复的伯努利试验

##### n重伯努利试验的成功次数

* 在n重伯努利试验中，记成功的次数为X
* X的可能取值为：0,1,…,n
* X取值为k的概率为：
  * $P(X=k)=C_n^kp^k(1-p)^{n-k}$